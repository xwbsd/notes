Vue 的数据驱动

- 视图是由数据驱动生成的，通过修改数据而不是操作 DOM，对视图进行修改。
- 简化了代码量，只关心数据的修改让代码的逻辑变得非常清晰，利于维护。

## new Vue

```javascript
function Vue(options) {
  // 检查 Vue 只能用 new 来调用
  this._init(options)
}

// src/core/instance/init.js
Vue.prototype._init = function (options) {
  const vm = this
  vm._uid = uid++

  // mark(startTag)

  vm._isVue = true

  // merge options 合并配置
  if (options && options._isComponent) {
    initInternalComponent(vm, options)
  } else {
    vm.$options = mergeOptions(
      resoleConstructorOptions(vm.constructor),
      options || {},
      vm
    )
  }

  // initProxy(vm)

  vm._self = vm

  // 初始化生命周期
  initLifecycle(vm)
  // 初始化事件中心
  initEvents(vm)
  // 初始化渲染
  initRender(vm)
  callHook(vm, "beforeCreate")
  initInjections(vm) // resolve injections before data/props
  // 初始化 data props computed watcher 等等
  initState(vm)
  initProvide(vm) // resolve provide after data/porps
  callHook(vm, "created")

  // mark(endTag)

  if (vm.$options.el) {
    vm.$mount()
  }
}
```

## vm.$mount

Vue 实例挂载方法 $mount 在多个文件中都有定义，因为其实现和平台、构建方式都相关。

```javascript
const mount = Vue.prototype.$mount
Vue.prototype.$mount = function(el, hydrating) {
  el = el && query(el)

  // 检查 el 不能挂载到 html/body, return

  const options = this.$options
  // resolve template/el and convert to render function
  if (!options.render) {
    let template = options.template
    if (template) {
      if (typeof template === 'string') {
        if (tempalte.charAt(0) === '#') {
          template = idToTemplate(template)

          // 检查 template 是否存在或为空
        }
      } else if (template.nodeType) {
        template = template.innerHTML
      } else {
        // 无效 template 配置 return
      }
    } else if (el) {
      template = getOuterHTML(el)
    }
    if (template) {
      // mark(compile)
    }
  }
}

```

