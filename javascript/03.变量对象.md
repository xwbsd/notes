当 JavaScript 执行一段可执行代码时，会创建对应的*执行上下文*，每个执行上下文都有三个重要属性：

- 变量对象 (Variable object, VO)
- 作用域链 (Scope chain)
- this

## 变量对象

是与执行上下文相关的数据作用域，存储了上下文中定义的变量和函数声明

#### 全局上下文

> 全局对象：是预定义的对象，作为 JavaScript 的全局函数和全局属性的占位符。通过使用全局对象可以访问所有其他预定义的对象、函数和属性。（w3school）

顶层 JavaScript 代码中通过*this*可以访问全对象，浏览器中就是*Window 对象*

```javascript
console.log(this); // Window {}

console.log(Math.random()); // this.Math.random() 预定于的函数、属性

var a = 1;
console.log(this.a); // 可以访问定义的全局变量

console.log(this.window.a === this.a); // true 浏览器环境this.window指向自身
```

而全局上下文的变量对象即这个全局对象

#### 函数上下文

通常用*活动对象(activation object, AO)*来表示变量对象。在执行上下文的两个生命周期：

- **创建阶段**

变量对象被创建, 其中会包括：

1. 函数的所有形参 (arguments: 没有实参时为 undefined)
2. 函数声明 (key: function-object)
3. 变量声明 (key: undefined)

```javascript
function foo(a) {
    var b = 2
    function c () {}
    var d = function () {}
    b = 3
}

foo.AO = {
    arguments: {
        0: 1,
        length: 1
    },
    a: 1,
    b: undefined,
    c: reference to function c() {},
    d: undefined
}
// AO = VO + function parameters + arguments
// 调用函数时，会为其创建一个Arguments对象，并自动初始化局部变量arguments，指代该Arguments对象。所有作为参数传入的值都会成为Arguments对象的数组元素。
```

- **代码执行阶段**

此时活动对象被激活，会顺序执行代码，对变量对象赋值。

```javascript
foo.AO = {
    arguments: {
        0: 1,
        length: 1
    },
    a: 1,
    b: 3,
    c: reference to function c() {},
    d: reference to FunctionExpression "d"
}
```